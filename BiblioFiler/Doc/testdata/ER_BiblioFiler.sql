
/* Drop Tables */

DROP TABLE TAG_RELATIONS;
DROP TABLE BOOKS;
DROP TABLE TAGS;




/* Create Tables */

CREATE TABLE BOOKS
(
	BOOK_ID INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	ISBN TEXT,
	TITLE TEXT,
	TITLE_KANA TEXT,
	SUB_TITLE TEXT,
	SUB_TITLE_KANA TEXT,
	AUTHOR TEXT,
	AUTHOR_KANA TEXT,
	PUBLISHER_NAME TEXT,
	SALES_DATE REAL,
	LIST_PRICE TEXT,
	ITEM_CAPTION TEXT,
	IMAGE NONE,
	PRIMARY KEY (BOOK_ID)
);


CREATE TABLE TAGS
(
	TAG_ID INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	NAME TEXT NOT NULL,
	USER_TAG_FLAG INTEGER DEFAULT 1 NOT NULL CHECK IN (0, 1),
	PRIMARY KEY (TAG_ID),
	CONSTRAINT CNST_TAG_RELATION UNIQUE (NAME, USER_TAG_FLAG)
);


CREATE TABLE TAG_RELATIONS
(
	_ID INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	TAG_ID INTEGER NOT NULL UNIQUE,
	BOOK_ID INTEGER NOT NULL UNIQUE,
	PRIMARY KEY (_ID),
	FOREIGN KEY (BOOK_ID)
	REFERENCES BOOKS (BOOK_ID),
	FOREIGN KEY (TAG_ID)
	REFERENCES TAGS (TAG_ID)
);



